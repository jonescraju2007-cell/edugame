<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EduGame Quiz</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1 id="quiz-title">ğŸ“ Quiz</h1>
    <nav>
      <button onclick="goLesson()">ğŸ“– Lesson</button>
      <button onclick="goWorlds()">ğŸŒ Worlds</button>
      <button onclick="toggleTheme()">ğŸŒ™ Toggle Theme</button>
    </nav>
  </header>

  <main id="quiz-content">
    <p>Loading quiz...</p>
  </main>

  <script>
    let currentQuestion = 0;
    let questions = [];

    async function loadQuiz() {
      const worldFile = localStorage.getItem("currentWorld") || "world1.json";
      const res = await fetch(`./worlds/${worldFile}`);
      const data = await res.json();

      document.getElementById("quiz-title").innerText = data.meta.title + " - Quiz";
      questions = data.quiz;

      showQuestion();
    }

    function showQuestion() {
      const container = document.getElementById("quiz-content");
      container.innerHTML = "";

      if (currentQuestion >= questions.length) {
        container.innerHTML = `<h2>ğŸ‰ Quiz Completed!</h2>`;
        return;
      }

      const q = questions[currentQuestion];
      const div = document.createElement("div");
      div.classList.add("quiz-card");
      div.innerHTML = `<h3>${q.q}</h3>`;

      q.options.forEach((opt, i) => {
        const btn = document.createElement("button");
        btn.innerText = opt;
        btn.onclick = () => checkAnswer(i, q.answer);
        div.appendChild(btn);
      });

      container.appendChild(div);
    }

    function checkAnswer(selected, correct) {
      if (selected === correct) {
        alert("âœ… Correct!");
      } else {
        alert("âŒ Wrong! Try again.");
        return;
      }
      currentQuestion++;
      showQuestion();
    }

    function goLesson() {
      window.location.href = "lesson.html";
    }

    function goWorlds() {
      window.location.href = "index.html";
    }

    function toggleTheme() {
      document.body.classList.toggle("dark");
    }

    loadQuiz();
  </script>
</body>
</html>

